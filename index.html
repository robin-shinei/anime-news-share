<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>アニメエンタメニュースサイト</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@tailwindcss/browser@4"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* 管理画面用のスタイル */
        #admin-panel {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            padding: 20px;
            overflow-y: auto;
        }
        #admin-panel.show {
            display: block;
        }
        #admin-panel-content {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            max-width: 800px;
            margin: 20px auto;
        }
        .news-card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 10px;
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            height: 100%;
            display: flex;
            flex-direction: column;
            border: 1px solid #e2e8f0;
        }

        .news-card:hover {
            transform: translateY(-4px) scale(1.02);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
            border-color: #cbd5e0;
        }

        .news-card h2 {
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
            color: #1e293b;
        }

        .news-card p {
            font-size: 0.875rem;
            color: #4b5563;
            margin-bottom: 0.5rem;
            flex-grow: 1;
        }

        .news-card a {
            color: #3b82f6;
            text-decoration: none;
            font-weight: 600;
            transition: color 0.2s ease-in-out;
        }

        .news-card a:hover {
            color: #2563eb;
        }

        .news-card .publish-date {
            font-size: 0.75rem;
            color: #9ca3af;
            margin-top: 0.5rem;
        }

        #news-list-container {
            display: none;
        }

        #news-list-container.show {
            display: block;
        }

    </style>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
</head>
<body class="bg-gray-100 p-6">
    <h1 class="text-3xl font-semibold text-center text-blue-700 mb-8">アニメエンタメニュース</h1>

    <div id="news-date-select" class="flex justify-center mb-8">
        <label for="date-dropdown" class="mr-4 text-lg text-gray-700">日付を選択:</label>
        <select id="date-dropdown" class="border border-gray-300 rounded-md shadow-sm px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
            <option value="">日付を選択してください</option>
        </select>
    </div>

    <div id="news-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    </div>

    <div class="text-center mt-8">
        <button id="admin-button" class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">管理画面</button>
    </div>

    <div id="admin-panel">
        <div id="admin-panel-content">
            <h2 class="text-2xl font-semibold mb-4">ニュース追加・編集</h2>
            <form id="add-news-form" class="mb-6">
                <div class="mb-4">
                    <label for="news-date" class="block text-gray-700 text-sm font-bold mb-2">日付:</label>
                    <input type="date" id="news-date" required class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                </div>
                <div class="mb-4">
                    <label for="news-title" class="block text-gray-700 text-sm font-bold mb-2">タイトル:</label>
                    <input type="text" id="news-title" required class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                </div>
                <div class="mb-4">
                    <label for="news-url" class="block text-gray-700 text-sm font-bold mb-2">URL:</label>
                    <input type="url" id="news-url" required class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                </div>
                <div class="mb-4">
                    <label for="news-summary" class="block text-gray-700 text-sm font-bold mb-2">概要:</label>
                    <textarea id="news-summary" required class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"></textarea>
                </div>
                <div class="mb-4">
                    <label for="news-publish-date" class="block text-gray-700 text-sm font-bold mb-2">配信日:</label>
                    <input type="date" id="news-publish-date" required class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                </div>
                <button type="submit" class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">追加</button>
            </form>
            <div id="message-container" class="mt-4 text-yellow-600 font-semibold"></div>
            <div id="news-list-container" class="mt-6">
                <h3 class="text-lg font-semibold mb-2">登録済みニュース一覧 (編集内容は一時的です)</h3> <!-- Updated title -->
                <ul id="news-list" class="border rounded-md p-4">
                </ul>
            </div>
            <button id="toggle-news-list" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline mt-4">非表示</button>
            <button id="close-admin-panel" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline mt-4">閉じる</button>
        </div>
    </div>

    <script>
        // THIS IS THE MASTER DATA EMBEDDED IN THE HTML
        const newsData = {
            "2025-03-21": [
                {
                    title: "転スラ×ロボットの学習漫画 掲載内容発表!AI(人工知能)ってなに?危なくないの?",
                    url: "https://www.oricon.co.jp/news/2374110/full/",
                    概要: "テレビアニメ『転スラ』とロボットのコラボ学習漫画『転生したらスライムだった件で学べるBOOK　ロボット』が、19日に発売されることが決定した。",
                    配信日: "2025年3月14日",
                    hidden: false
                },
                {
                    title: "TOHO animation、新作アニメ発表へ 謎のほうき星…作品モチーフのビジュアル公開",
                    url: "https://www.oricon.co.jp/news/2374050/",
                    概要: "東宝が2012年に設立したアニメーションレーベル【TOHO animation】が、17日午後7時に新作アニメを発表することが14日、わかった。",
                    配信日: "2025年3月14日",
                    hidden: false
                },
                {
                    title: "【万博】アニメイト新情報、POP-UP第1弾で『ヒロアカ』など 島本和彦氏が兄沢命斗描き下ろしも",
                    url: "https://www.oricon.co.jp/news/2374170/",
                    概要: "アニメイトは、大阪・関西万博(4月13日開幕、大阪・夢洲)に「アニメイト大阪・関西万博店」を出店する。POP-UPスペース第1弾は「ボンズストア」となることが明らかになった。",
                    配信日: "2025年3月14日",
                    hidden: false
                },
                {
                    title: "『卓球少女』、中国発の卓球アニメを日本語吹替版で劇場上映 メインキャストに夏川椎菜&雨宮天ら",
                    url: "https://www.oricon.co.jp/news/2374098/full/",
                    概要: "中国発のアニメ『白色閃電 Pingpong！』の日本語吹替版劇場アニメ『卓球少女―閃光のかなたへ―』の制作が決定。あわせて5月16日から全国で公開されることが決定した。",
                    配信日: "2025年3月14日",
                    hidden: false
                },
                {
                    title: "【日本アカデミー賞】最優秀アニメーション作品賞は『ルックバック』押山清高監督、宮崎駿監督との秘話を明かす",
                    url: "https://www.oricon.co.jp/news/2374193/full/",
                    概要: "「第48回 日本アカデミー賞」授賞式が14日、東京・グランドプリンスホテル新高輪にて開催され、最優秀アニメーション作品賞を『ルックバック』が受賞した。",
                    配信日: "2025年3月14日",
                    hidden: false
                },
                {
                    title: "「第3回新潟国際アニメーション映画祭」が開幕 アニメの未来を語り合う6日間",
                    url: "https://www.oricon.co.jp/news/2373992/full/",
                    概要: "新潟市中央区で15日、「第3回新潟国際アニメーション映画祭」が開幕した。新潟市民プラザ、新潟日報メディアシップ、映画館のT・ジョイ、シネ・ウインドの4会場で20日まで開催される。",
                    配信日: "2025年3月15日",
                    hidden: false
                },
                {
                    title: "タカラトミー、YouTubeショートアニメ『トランスフォーマー ワイルドキング』を3月26日から配信!新合体ギミックの玩具は4月に発売",
                    url: "https://gamebiz.jp/news/402564",
                    概要: "カラトミーは、変形ロボットキャラクター『トランスフォーマー』の日本オリジナル新作ショートアニメ『トランスフォーマー ワイルドキング』を、2025年3月26日からタカラトミー公式YouTubeチャンネル「タカラトミーチャンネル」で配信を開始する。",
                    配信日: "2025年3月18日",
                    hidden: false
                },
                {
                    title: "ドワンゴ、「AnimeJapan 2025」AJステージの33プログラムをニコ生で無料中継！『鬼滅の刃』『薬屋のひとりごと』など注目タイトルが勢揃い",
                    url: "https://gamebiz.jp/news/402594",
                    概要: "ドワンゴは、ライブ配信サービス「ニコニコ生放送」で、3月22日・3月23日の2日間にわたり東京ビッグサイトで開催される世界最大級のアニメイベント「AnimeJapan2025」AJステージの33プログラムを無料で生中継する。",
                    配信日: "2025年3月18日",
                    hidden: false
                },
                {
                    title: "IPビジネスを深化させる｢リアル経済圏｣の威力　アニメ産業内｢意外な巨大市場｣を牽引する企業",
                    url: "https://toyokeizai.net/articles/-/859993",
                    概要: "IPビジネスを深化させる｢リアル経済圏｣の威力、アニメ産業内｢意外な巨大市場｣を牽引する企業について。",
                    配信日: "2025年3月14日",
                    hidden: false
                },
                {
                    title: "Adoの叫び声が話題 名曲「ゲゲゲの鬼太郎」熱唱で「妖怪側のそれ」「迫真すぎる」",
                    url: "https://www.oricon.co.jp/news/2374473/full/",
                    概要: "歌い手のAdoが、アニメ『ゲゲゲの鬼太郎』の傑作選『ゲゲゲの鬼太郎　私の愛した歴代ゲゲゲ』（フジテレビ系　4月6日午前9時～）のオープニング主題歌「ゲゲゲの鬼太郎」を担当する。",
                    配信日: "2025年3月19日",
                    hidden: false
                },
                {
                    title: "米津玄師×羽生結弦の共演MV、ついに再生数1000万回突破 『メダリスト』OPで注目続く",
                    url: "https://www.oricon.co.jp/news/2374303/full/",
                    概要: "歌手・米津玄師が歌う、テレビアニメ『メダリスト』オープニング主題歌「BOW AND ARROW」のミュージックビデオの再生数が16日、1000万回を突破した。",
                    配信日: "2025年3月16日",
                    hidden: false
                },
                {
                    title: "［週刊エンタメ］アニメ「おぼっちゃまくん」　おかげ茶魔でインドで人気爆発ぶぁい！",
                    url: "https://www.yomiuri.co.jp/culture/20250313-OYT8T50093/",
                    概要: "平成の初めにヒットしたアニメ「おぼっちゃまくん」が今、インドで大人気だ。子どもたちのハートをつかみ、新作の制作も現地で進行している。少し下品で、ダジャレも連発されるジャパニーズギャグアニメがなぜ？",
                    配信日: "2025年3月14日",
                    hidden: false
                },
                {
                    title: "フジテレビ　アニメ「ワンピース」放送が深夜に移動　18年ぶりの枠変更　日曜の朝の楽しみが…衝撃の声",
                    url: "https://www.sponichi.co.jp/entertainment/news/2025/03/12/kiji/20250312s00041000148000c.html",
                    概要: "現在日曜の朝にフジテレビで放送中の人気アニメ「ワンピース」が、4月から日曜午後11時15分放送の枠に移動することが分かった。12日、フジテレビが改編資料を通じて発表した。",
                    配信日: "2025年3月12日",
                    hidden: false
                },
                {
                    title: "ABCテレビが日曜深夜にアニメ枠を新設決定、第一弾作品は『日々は過ぎれど飯うまし』！　アニメ放送枠のネーミングを一般公募実施",
                    url: "https://www.animatetimes.com/news/details.php?id=1741859016",
                    概要: "ABC朝日放送テレビが、毎週日曜深夜（時間未定）にアニメの放送に特化したアニメ番組枠を新設することを発表しました！",
                    配信日: "2025年3月13日",
                    hidden: false
                },
                {
                    title: "アニメ・ゲーム・VR等コンテンツ領域でのIPアイデアのビジネス構築を促進するプログラム「TCIC Ideation Program 2024」のミートアップを2月10日に開催",
                    url: "https://prtimes.jp/main/html/rd/p/000000379.000033548.html",
                    概要: "株式会社ツクリエは、東京都から受託し運営する施設「東京コンテンツインキュベーションセンター（以下、TCIC）」のプログラム「TCIC Ideation Program 2024（TCIC IP）」の集大成として、2025年2月10日（月）に東京・虎ノ門にあるCIC Tokyoでミートアップイベント（以下、本イベント）を開催いたしました。",
                    配信日: "2025年3月12日",
                    hidden: false
                },
                {
                    title: "Andraftが代々木アニメーション学院、スターリーキューブと共にアニメーション制作会社「株式会社Aurora Animation」を設立！",
                    url: "https://prtimes.jp/main/html/rd/p/000000001.000158835.html",
                    概要: "株式会社Andraft、株式会社代々木アニメーション学院、株式会社スターリーキューブの三社は、 アニメーション制作会社「株式会社Aurora Animation（オーロラ アニメーション）」 を共同で設立することをお知らせいたします。",
                    配信日: "2025年3月10日",
                    hidden: false
                },
                {
                    title: "経産省がエンタメ戦略をとりまとめ　アニメーターの就労環境改善など",
                    url: "https://www.nikkei.com/article/DGXZQOUA114F2011032025000000/",
                    概要: "経済産業省は11日、アニメや音楽などエンターテインメント産業の海外展開などに関する戦略の中間とりまとめ案を有識者会議で示した。アニメーターの就労環境を改善することなどが主な内容で、政府が経済財政運営の指針とする「骨太の方針」に盛り込むことをめざす。",
                    配信日: "2025年3月11日",
                    hidden: false
                },
                {
                    title: "DLE、ミドルクオリティのアニメを低コストかつ短納期で実現する「オルタナティブ・アニメ」事業を開始 第1弾は『野原ひろし 昼メシの流儀』",
                    url: "https://gamebiz.jp/news/402272",
                    概要: "DLEは、テレビ放送や配信を目的とした30分のアニメ・シリーズ(1クール、全12話)をメインの領域として、DLEのAdobe Animateによる制作ノウハウを活かし進化させたミドルクォリティのアニメーションを通常の2Dアニメ会社よりも低コスト且つ短期間で制作するというもの。",
                    配信日: "2025年3月18日",
                    hidden: false
                },
                {
                    title: "クリエイターが創作に没頭できる環境を―Creator's XがAI活用で挑むアニメ業界オープンイノベーション",
                    url: "https://prtimes.jp/main/html/rd/p/000000022.000109712.html",
                    概要: "生成AIの台頭によりクリエイティブ産業が大きく変わりつつある今、アニメ制作の現場にも変革の波が訪れています。Creator’s Xは「創るに没頭しよう」をビジョンに掲げ、AIをアニメーターのアシスタントとして活用する新しいアニメ制作の形を提案。",
                    配信日: "2025年3月10日",
                    hidden: false
                },
                {
                    title: "アニプレックスとCrunchyroll、共同出資によるアニメプロデュース会社「HAYATE」設立",
                    url: "https://branc.jp/article/2025/03/19/1483.html",
                    概要: "アニプレックスおよびCrunchyroll, LLCの二社は、共同出資によりHAYATEを設立したことを発表した。",
                    配信日: "2025年3月19日",
                    hidden: false
                },
                {
                    title: "卒業制作アニメの続編がTVアニメ化決定　3D作品『銀河特急 ミルキー☆サブウェイ』7月放送",
                    url: "https://news.yahoo.co.jp/articles/cd57f67ec4715d1dc25c26fad1e9ed019042ec0f",
                    概要: "自主制作短編3Dアニメ『ミルキー☆ハイウェイ』の続編が、『銀河特急 ミルキー☆サブウェイ』としてTVアニメ化。7月に放送および配信されることが決定した。",
                    配信日: "2025年3月20日",
                    hidden: false
                }
            ],
            "2025-04-04": [
                {
                    title: "関係会社株式の譲渡及び関係会社株式売却益計上見込みに関するお知らせ",
                    url: "https://mediado.jp/corporate/8360/",
                    概要: "株式会社メディアドゥは、持分法適用会社である株式会社MyAnimeListの全保有株式を株式会社Gaudiyに譲渡することを決議。これによりMyAnimeListは関連会社から外れる。",
                    配信日: "2025年3月27日",
                    hidden: false
                },
                {
                    title: "サイバーエージェントとSNSの”X“ アニメのグローバルプロモーションで協力",
                    url: "http://animationbusiness.info/archives/16599",
                    概要: "CyberAgent AmericaとX Corp. Japanが、アニメのグローバル展開におけるマーケティングパートナーシップを締結。サイバーエージェントは米国法人を通じてグローバルマーケティング事業を強化。",
                    配信日: "2025年4月3日",
                    hidden: false
                },
                {
                    title: "麻布台ヒルズで高畑勲展　「火垂るの墓」に注目も",
                    url: "http://animationbusiness.info/archives/16596",
                    概要: "2025年6月27日から9月15日まで麻布台ヒルズ ギャラリーにて「高畑勲展 ̶日本のアニメーションを作った男。」が開催される。特に『火垂るの墓』に注目が集まる。",
                    配信日: "2025年3月31日",
                    hidden: false
                },
                {
                    title: "解説：アニメ、地上波回帰のワケ　ジャンルとしてのメリットと弱点",
                    url: "https://mantan-web.jp/article/20250330dog00m200004000c.html",
                    概要: "新年度の地上波テレビではアニメジャンルが伸長。動画配信が普及する中、再び地上波でアニメを編成する意義と、そのメリット・弱点を探る。",
                    配信日: "2025年3月30日",
                    hidden: false
                },
                {
                    title: "アニメ制作など４５業者に公取委が是正指導、フリーランス取引適正化法違反で…初公表",
                    url: "https://www.yomiuri.co.jp/national/20250328-OYT1T50133/",
                    概要: "公正取引委員会は、アニメ制作など4業種の計45業者に対し、フリーランス取引適正化法違反（取引条件の不明示など）で是正指導を行ったと発表。同法施行後初の指導公表。",
                    配信日: "2025年3月28日",
                    hidden: false
                },
                {
                    title: "(令和7年3月28日)特定受託事業者に係る取引の適正化等に関する法律に基づく指導について",
                    url: "https://www.jftc.go.jp/houdou/pressrelease/2025/mar/250328_FL.html",
                    概要: "公正取引委員会は、フリーランス・事業者間取引適正化等法に基づき、ゲームソフトウェア業、アニメーション制作業など4業種の45事業者に対し、契約書記載や支払期日等の是正指導を行った。",
                    配信日: "2025年3月28日",
                    hidden: false
                },
                {
                    title: "人気アニメランキングを“10代限定”で集計すると…ラノベ原作がマンガを差し置き堂々首位",
                    url: "https://0115765.com/archives/120767",
                    概要: "ABEMAが発表した「10代男女に人気なアベマアニメTOP5」で、『Re:ゼロから始める異世界生活』が1位を獲得。ライトノベル原作作品が強い支持を集めた。",
                    配信日: "2025年3月27日",
                    hidden: false
                },
                {
                    title: "個人や少人数制作が加速するアニメーション業界！新時代のアニメーションクリエイター100組が集結した書籍『ANIMATION CREATORS 100』が刊行！",
                    url: "https://prtimes.jp/main/html/rd/p/000000001.000158487.html",
                    概要: "株式会社芸術新聞社は、新進気鋭からインディ作家まで、今注目すべきアニメーションクリエイター100組を紹介する書籍『ANIMATION CREATORS 100』を発売。",
                    配信日: "2025年3月24日",
                    hidden: false
                },
                {
                    title: "アニメーション制作会社の株式会社サエッタが鹿児島市に進出！",
                    url: "https://prtimes.jp/main/html/rd/p/000000039.000100148.html",
                    概要: "東京のアニメーション制作会社、株式会社サエッタが鹿児島市と立地協定を締結。鹿児島市はコンテンツ制作業企業の誘致を進めている。",
                    配信日: "2025年3月28日",
                    hidden: false
                },
                {
                    title: "Apple TV+の損失は年間で10億ドル、加入者は4,500万人",
                    url: "https://branc.jp/article/2025/04/04/1496.html",
                    概要: "Apple TV+は加入者4,500万人を抱えるものの、年間10億ドルの損失を出していると報じられた。コンテンツには年間約45億ドルを費やしている。",
                    配信日: "2025年4月4日",
                    hidden: false
                },
                {
                    title: "北米IMAXシアターで公開の4K版『もののけ姫』、わずか330スクリーンで興収400万ドルと好調",
                    url: "https://www.cinemacafe.net/article/2025/03/31/98901.html",
                    概要: "北米のIMAXシアターで公開された4Kリストア版『もののけ姫』が、わずか330スクリーンで興行収入400万ドルを超える好調なスタートを切った。",
                    配信日: "2025年3月31日",
                    hidden: false
                },
                {
                    title: "「風の谷のナウシカ」、台湾で興行収入約1億6000万円に 特典ポスターが話題",
                    url: "https://japan.focustaiwan.tw/entertainment-sport/202503260006",
                    概要: "台湾で初公開された「風の谷のナウシカ」が興行収入約1億6000万円を記録。台湾限定の来場者特典ポスターなどが話題を呼んでいる。",
                    配信日: "2025年3月26日",
                    hidden: false
                }
            ],
            "2025-04-11": [
                {
                    title: "MAPPA、音楽レーベル「mappa records」設立 ライブ運営などにも挑戦「“心に残るアニメ”をお届けするために」",
                    url: "https://www.oricon.co.jp/news/2377159/",
                    概要: "『呪術廻戦』『チェンソーマン』『「進撃の巨人」The Final Season』などで知られるアニメ制作会社のMAPPAは、4月1日より新たに音楽レーベル「mappa records」を設立したことを発表した。",
                    配信日: "2025年4月1日",
                    hidden: false
                },
                {
                    title: "文化放送『超!A&G+』終了で17年半に幕 生放送4時間に声優20人参加で思い出話「ラジオから始まった声優人生でした」【コメント抜粋】",
                    url: "https://www.oricon.co.jp/news/2377049/",
                    概要: "文化放送は、3月31日をもって同社が運営するアニメ&ゲーム&声優コンテンツのインターネットラジオ『超!A&G+』のサービスを終了させた。",
                    配信日: "2025年3月31日",
                    hidden: false
                },
                {
                    title: "京アニ初の実写合成+アニメ映画公開へ? 『小林さちこのメイドラゴン』4年ぶり復活",
                    url: "https://www.oricon.co.jp/news/2376983/full/",
                    概要: "歌手・小林幸子とアニメ映画『小林さんちのメイドラゴン』のエイプリルフール企画が発表された。京都アニメーション初の実写合成＋アニメの映画『小林さちこのメイドラゴン さみしがりやの竜』を6月27日に公開する。",
                    配信日: "2025年4月1日",
                    hidden: false
                },
                {
                    title: "『ぼのぼの』3年間にわたるアニバーサリー企画スタート! 開幕は周年記念ビール発売から",
                    url: "https://www.oricon.co.jp/news/2377374/",
                    概要: "2026年に漫画『ぼのぼの』が連載40周年、テレビアニメ『ぼのぼの』が放送10周年を迎えることを記念して、きょう2日よりアニバーサリープロジェクトが開始される。2028年3月までの3年間をアニバーサリーイヤーとして、コラボやイベントなどさまざまな企画を準備している。",
                    配信日: "2025年4月2日",
                    hidden: false
                },
                {
                    title: "コードギアス×ポプテピピック正式コラボ 実写映像『ポプテギアス』公開でポプ子役を櫻井孝宏、ピピ美役を福山潤",
                    url: "https://www.oricon.co.jp/news/2377400/full/",
                    概要: "大人気アニメ『ポプテピピック』と『コードギアス 反逆のルルーシュ』がコラボレーションすることが決定した。4月1日のエイプリルフール企画でコラボビジュアルが解禁されていたが、正式にコラボ企画が続々と発表された。",
                    配信日: "2025年4月2日",
                    hidden: false
                },
                {
                    title: "『ガンダムW』30周年企画が始動でファン歓喜「新作やってほしい」「この手紙は…」",
                    url: "https://www.oricon.co.jp/news/2377337/full/",
                    概要: "大人気アニメ『新機動戦記ガンダムW』30周年記念プロジェクトが始動した。あわせてドレスアップしたヒイロとリリーナを描いた30周年記念ビジュアルが公開され、ネット上では歓喜の声があがっている。",
                    配信日: "2025年4月2日",
                    hidden: false
                },
                {
                    title: "B'z『ルパン三世』新作映画で主題歌担当 6月公開で予告映像が解禁!稲葉浩志「緊張感を意識」",
                    url: "https://www.oricon.co.jp/news/2377734/",
                    概要: "大人気アニメ『ルパン三世』の完全新作映画『LUPIN THE IIIRD THE MOVIE 不死身の血族』が、6月27日に公開されることが決定した。",
                    配信日: "2025年4月4日",
                    hidden: false
                },
                {
                    title: "ジャンプ漫画家『メダリスト』ネタのコラボ絵描く 「見なよ…私の」に大反響「出版社の壁を越えたw」",
                    url: "https://www.oricon.co.jp/news/2377803/full/",
                    概要: "漫画『ウマ娘 シンデレラグレイ』作者・久住太陽氏が、自身のXを更新し、ウマ娘キャラと使った『メダリスト』で話題となった「見なよ…」イラストを投稿した。",
                    配信日: "2025年4月4日",
                    hidden: false
                },
                {
                    title: "『ウマ娘』新アニメ話題 トレンド1位で令和に「オグリキャップ」再ブーム「名乗る時のカットが」「体感5分」",
                    url: "https://www.oricon.co.jp/news/2378126/",
                    概要: "テレビアニメ『ウマ娘 シンデレラグレイ』第1話が6日、TBS系(分割2クールにて放送)で放送された。Xでは、「#シングレ」「オグリキャップ」など関連ワードがトレンド入りした",
                    配信日: "2025年4月6日",
                    hidden: false
                },
                {
                    title: "Travis Japan松田元太、映画『たべっ子どうぶつ』らいおんくんと登場 “松田節”でアピール「全人類楽しんでいただける」",
                    url: "https://www.oricon.co.jp/news/2377820/full/",
                    概要: "Travis Japanの松田元太が7日、都内で行われた『たべっ子どうぶつ THE MOVIE』(5月1日公開）の完成披露試写会に登場。自身が声優を務めた“らいおんくん”らどうぶつたちとともに登場して観客を沸かせた。",
                    配信日: "2025年4月7日",
                    hidden: false
                },
                {
                    title: "東野圭吾氏『クスノキの番人』、2026年にアニメーション映画化 東野作品では初【コメント全文】",
                    url: "https://www.oricon.co.jp/news/2378341/",
                    概要: "小説家・東野圭吾氏の小説『クスノキの番人』がアニメーション映画化されることが決定した。東野氏の作品のアニメーション映画化は本作が初めてとなる。",
                    配信日: "2025年4月8日",
                    hidden: false
                },
                {
                    title: "高橋文哉&原田泰造&麻生久美子、20年後の野原家に 初の『クレヨンしんちゃん』実写化ショートムービー",
                    url: "https://www.oricon.co.jp/news/2378243/",
                    概要: "テレビアニメ『クレヨンしんちゃん』が「やかんの麦茶 from 爽健美茶」とタッグを組んだ、クレヨンしんちゃん初の実写化ショートムービーが9日、公開された。",
                    配信日: "2025年4月9日",
                    hidden: false
                },
                {
                    title: "「ルックバック」にグランプリ　第3回新潟国際アニメーション映画祭",
                    url: "http://animationbusiness.info/archives/16606",
                    概要: "長編アニメーションにフォーカスした国際映画祭として注目される第3回新潟国際アニメーション映画祭が2025年3月15日から20日までの6日間、新潟市内で開催された。最終日となった20日のクロージングセレモニーでは、アニメーションの技術職を対象にしたアワード大川博賞・蕗谷虹児賞の授賞式、さらに映画祭の目玉となる長編コンペティションの発表、授賞も行われた。",
                    配信日: "2025年4月9日",
                    hidden: false
                },
                {
                    title: "KeyHolderグループが映画配給事業スタート　アドバイザーに井上伸一郎氏",
                    url: "http://animationbusiness.info/archives/16603",
                    概要: "映像番組制作などのエンタテイメント企業KeyHolderグループが、映画配給に進出する。同グループの番組制作会社UNITED PRODUCTIONSは、2025年4月1日付で映画配給事業を開始し、配給レーベル「KeyHolder Pictures」を設立した。",
                    配信日: "2025年4月8日",
                    hidden: false
                },
                {
                    title: "【2025年冬アニメ総括】冬アニメは”4強”が圧倒！サブスクごとの人気作品と視聴傾向を徹底分析",
                    url: "https://gamebiz.jp/news/403222",
                    概要: "2025年の冬アニメでは、「SAKAMOTO DAYS」「薬屋のひとりごと」「シャングリラ・フロンティア」「俺だけレベルアップな件」が各配信サービスで圧倒的な人気を誇った。一方で、「いずれ最強の錬金術師？」「没落予定の貴族だけど、暇だったから魔法を極めてみた」などの異世界作品も安定した人気を維持。本稿ではdアニメストア、DMM TV、ABEMAの傾向を見ながら、2025年冬の人気作を振り返る。",
                    配信日: "2025年3月29日",
                    hidden: false
                },
                {
                    title: "ハリウッドとCG映画合作した唯一の日本CGアニメ会社MARZA。ソニック1000億円興行はどうやって実現したのか 中山淳雄の「推しもオタクもグローバル」第116回",
                    url: "https://gamebiz.jp/news/403398",
                    概要: "『Sonic the Hedgehog 3』は興行収入700億円超え。『The Super Mario Bros. Movie』に次ぐ日本IP映画の成果。セガ自身が参画し「日本企業が参画して世界映像市場を獲った作品」。制作に関与したMARZAの視点から「日本IPのハリウッド映画化」についてインタビュー。",
                    配信日: "2025年4月4日",
                    hidden: false
                },
                {
                    title: "ヒット作はコナン､ハイキュー!!､ガンダム…｢観客動員数5000万人減｣の映画館がアニメばかりになった理由",
                    url: "https://president.jp/articles/-/93534",
                    概要: "クリント・イーストウッド監督最新作『陪審員2番』が日本ではU-NEXT配信のみに。監督作が映画館で公開されないのは51年ぶり。背景には日本における外国映画の著しい不調がある。",
                    配信日: "2025年3月30日",
                    hidden: false
                },
                {
                    title: "ＡＩ、アニメ・漫画キャラ生成＝原作と「ほぼ同一」事例も―著作権侵害に懸念・開発各社",
                    url: "https://biz-journal.jp/it/post_387253.html",
                    概要: "生成ＡＩサービスで誰でもアニメや漫画のキャラを作れるが、既存キャラとほぼ同一のものが生成され著作権侵害の懸念が高まる。オープンＡＩは「チャットＧＰＴ」に画像生成の新機能を加え、ジブリ風画像などが拡散。権利侵害の歯止めは疑問視されている。",
                    配信日: "2025年3月30日",
                    hidden: false
                },
                {
                    title: "アニメが好調!?　～映画業界の動向～",
                    url: "https://www.meti.go.jp/statistics/toppage/report/minikaisetsu/hitokoto_kako/20250404hitokoto.html",
                    概要: "2024年は「名探偵コナン １００万ドルの五稜星」や「劇場版ハイキュー！！ゴミ捨て場の決戦」が興収１００億円超え。邦画実写も健闘したが、洋画は１００億円超え作品なし。映画業界の動向をみる。",
                    配信日: "2025年4月4日",
                    hidden: false
                },
                {
                    title: "金融の力でコンテンツ産業に革新を。〈みずほ〉が立ち上げるアニメ映画ファンド",
                    url: "https://www.mizuho-fg.co.jp/journal/articles/konna02_anime/index.html",
                    概要: "アニメ映画に新しい資金調達の道を開き、日本のアニメ産業を盛り上げるため、〈みずほ〉がアニメ映画に出資するファンド「Talent of Talents」を設立。クエストリーとみずほ証券が連携し、金融の仕組みで製作費用を集め、より大きな予算の作品制作や機会創出を目指す。",
                    配信日: "2025年4月4日",
                    hidden: false
                }
            ]
        };

        // Global variable to hold the currently displayed news data
        let groupedNews = {}; // Will be populated on window.onload

        const newsContainer = document.getElementById('news-container');
        const dateDropdown = document.getElementById('date-dropdown');
        const adminPanel = document.getElementById('admin-panel');
        const adminButton = document.getElementById('admin-button');
        const closeAdminPanelButton = document.getElementById('close-admin-panel');
        const addNewsForm = document.getElementById('add-news-form');
        const messageContainer = document.getElementById('message-container');
        const newsList = document.getElementById('news-list');
        const newsListContainer = document.getElementById('news-list-container');
        const toggleNewsListButton = document.getElementById('toggle-news-list');

        let editingIndex = null; // Tracks the global index being edited in the admin panel
        let isNewsListVisible = true; // Tracks visibility of the admin news list

        // Function to display news for a selected date
        function displayNews(selectedDate) {
            newsContainer.innerHTML = ''; // Clear previous news
            if (selectedDate && groupedNews[selectedDate]) {
                // Sort news within the selected date (e.g., by publish date descending) - Optional but good practice
                const sortedNewsForDate = groupedNews[selectedDate]
                    .map(news => ({ ...news, sortDate: formatInputDate(news.配信日) || '0000-00-00' })) // Add a parseable date
                    .sort((a, b) => new Date(b.sortDate) - new Date(a.sortDate)); // Sort descending

                sortedNewsForDate.forEach(news => {
                    if (!news.hidden) { // Only show if not hidden
                        const newsCard = document.createElement('div');
                        newsCard.className = 'news-card';

                        const titleElement = document.createElement('h2');
                        titleElement.textContent = news.title;

                        const summaryElement = document.createElement('p');
                        summaryElement.textContent = news.概要;

                        const linkElement = document.createElement('a');
                        linkElement.href = news.url;
                        linkElement.textContent = '続きを読む';
                        linkElement.target = '_blank'; // Open in new tab
                        linkElement.rel = 'noopener noreferrer'; // Security best practice

                        const publishDateElement = document.createElement('p');
                        publishDateElement.className = 'publish-date';
                        publishDateElement.textContent = `配信日：${news.配信日}`;

                        newsCard.appendChild(titleElement);
                        newsCard.appendChild(summaryElement);
                        newsCard.appendChild(linkElement);
                        newsCard.appendChild(publishDateElement);
                        newsContainer.appendChild(newsCard);
                    }
                });
            } else if (selectedDate) {
                // If date exists but has no visible news or doesn't exist in groupedNews
                newsContainer.innerHTML = '<p class="text-gray-500 text-center">該当する日付のニュースはありません。</p>';
            } else {
                // If no date is selected
                newsContainer.innerHTML = '<p class="text-gray-500 text-center">日付を選択してください。</p>';
            }
        }

        // Event listener for the date dropdown
        dateDropdown.addEventListener('change', (event) => {
            const selectedDate = event.target.value;
            displayNews(selectedDate);
        });

        // Event listener for opening the admin panel
        adminButton.addEventListener('click', () => {
            // When opening admin, load the *current* state from localStorage if it exists,
            // otherwise use the initial data from the page load (already in groupedNews).
            // This allows resuming temporary edits within the same browser session.
            try {
                const storedAdminData = localStorage.getItem('groupedNews');
                if (storedAdminData) {
                    // Make sure it's valid JSON before parsing
                    groupedNews = JSON.parse(storedAdminData);
                    console.log("Admin panel opened, loading temporary data from localStorage.");
                } else {
                     console.log("Admin panel opened, using initial page data (no temporary data found).");
                     // groupedNews is already initialized from newsData on page load
                }
            } catch (error) {
                 console.error("Error loading admin data from localStorage:", error);
                 // Fallback to the data loaded initially from the page if localStorage is corrupt
                 groupedNews = JSON.parse(JSON.stringify(newsData));
            }

            adminPanel.classList.add('show');
            populateNewsList(); // Populate list based on potentially updated groupedNews
            newsListContainer.classList.toggle('show', isNewsListVisible);
            toggleNewsListButton.textContent = isNewsListVisible ? '非表示' : '表示';
            addNewsForm.reset(); // Clear form
            editingIndex = null; // Reset editing state
            addNewsForm.querySelector('button[type="submit"]').textContent = '追加';
            messageContainer.textContent = ''; // Clear messages
        });


        // Event listener for closing the admin panel
        closeAdminPanelButton.addEventListener('click', () => {
            adminPanel.classList.remove('show');
            // No need to reset groupedNews here; changes are temporary anyway
            // and will be overwritten on next page load or next admin open without localStorage data.
        });

        // Event listener for submitting the add/edit news form
        addNewsForm.addEventListener('submit', (event) => {
            event.preventDefault();

            const date = document.getElementById('news-date').value;
            const title = document.getElementById('news-title').value;
            const url = document.getElementById('news-url').value;
            const summary = document.getElementById('news-summary').value;
            const publishDateInput = document.getElementById('news-publish-date').value;

            // Format the publish date for display consistency
            let publishDateDisplay = publishDateInput;
            try {
                const dateObj = new Date(publishDateInput + 'T00:00:00');
                if (!isNaN(dateObj.getTime())) {
                    publishDateDisplay = `${dateObj.getFullYear()}年${dateObj.getMonth() + 1}月${dateObj.getDate()}日`;
                }
            } catch (e) {
                console.warn("Could not format display date from input:", publishDateInput);
            }

            let originalDate = null;
            let actualIndexInDate = -1;
            if (editingIndex !== null) {
                const newsInfo = getNewsByGlobalIndex(editingIndex);
                if (newsInfo) {
                    originalDate = newsInfo.date;
                    actualIndexInDate = newsInfo.indexInDate;
                } else {
                     messageContainer.textContent = '編集対象が見つかりません。新規追加として処理します。';
                     editingIndex = null; // Treat as new add if index is broken
                     addNewsForm.querySelector('button[type="submit"]').textContent = '追加';
                }
            }

            if (editingIndex !== null && originalDate !== null && actualIndexInDate !== -1) {
                // Editing existing news
                const newsItem = { title, url, 概要: summary, 配信日: publishDateDisplay, hidden: groupedNews[originalDate][actualIndexInDate].hidden }; // Preserve hidden status

                if (originalDate === date) {
                    groupedNews[originalDate][actualIndexInDate] = newsItem;
                } else {
                    groupedNews[originalDate].splice(actualIndexInDate, 1);
                    if (groupedNews[originalDate].length === 0) {
                        delete groupedNews[originalDate];
                    }
                    if (!groupedNews[date]) {
                        groupedNews[date] = [];
                    }
                    groupedNews[date].unshift(newsItem); // Add to top of new date
                }
                messageContainer.textContent = 'ニュースを編集しました (一時的)。';
                addNewsForm.querySelector('button[type="submit"]').textContent = '追加';
                editingIndex = null;

            } else {
                // Adding new news
                const newNews = { title, url, 概要: summary, 配信日: publishDateDisplay, hidden: false }; // New items are visible by default
                if (!groupedNews[date]) {
                    groupedNews[date] = [];
                }
                groupedNews[date].unshift(newNews); // Add to top
                messageContainer.textContent = 'ニュースを追加しました (一時的)。';
            }

            // Save the *temporary* changes to localStorage for the admin session
            try {
                localStorage.setItem('groupedNews', JSON.stringify(groupedNews));
                 console.log("Temporary admin changes saved to localStorage.");
            } catch (error) {
                console.error('localStorageへの一時保存に失敗しました:', error);
                messageContainer.textContent = 'エラー：変更の一時保存に失敗しました。';
                // Don't return, allow UI updates anyway
            }

            addNewsForm.reset();
            populateNewsList(); // Update admin list with temporary changes
            updateDateDropdown(); // Update dropdown if dates changed

            // IMPORTANT: The main news display (outside admin) IS NOT updated here
            // because it reflects the source HTML data, not the temporary admin edits.
            // displayNews(dateDropdown.value); // <-- DO NOT call this here

            // Hide message after a few seconds
            setTimeout(() => { messageContainer.textContent = ''; }, 3000);
        });

        // Function to populate the news list in the admin panel
        function populateNewsList() {
            newsList.innerHTML = '';
            let globalIndex = 0;
            const sortedAdminDates = Object.keys(groupedNews).sort((a, b) => new Date(b) - new Date(a));

            sortedAdminDates.forEach(date => {
                 // Sort news within each date for consistent admin list order (e.g., by publish date)
                 const sortedNewsForAdminDate = groupedNews[date]
                    .map(news => ({ ...news, sortDate: formatInputDate(news.配信日) || '0000-00-00' }))
                    .sort((a, b) => new Date(b.sortDate) - new Date(a.sortDate));

                 sortedNewsForAdminDate.forEach(news => {
                    const listItem = document.createElement('li');
                    listItem.className = 'border-b py-2 flex justify-between items-center';
                    listItem.innerHTML = `
                        <div>
                            <p class="font-semibold ${news.hidden ? 'text-gray-400 line-through' : ''}">${news.title} (${date})</p>
                            <p class="text-gray-500 text-sm">配信日：${news.配信日}</p>
                        </div>
                        <div>
                            <button class="bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-1 px-2 rounded focus:outline-none focus:shadow-outline text-xs mr-1 edit-button" data-index="${globalIndex}">編集</button>
                            <button class="bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-2 rounded focus:outline-none focus:shadow-outline text-xs delete-button" data-index="${globalIndex}">削除</button>
                        </div>
                    `;
                    newsList.appendChild(listItem);
                    globalIndex++;
                 });
            });

            addEventListenerToButtons();
        }

        // Function to update the main date dropdown options
        function updateDateDropdown() {
            const currentSelectedValue = dateDropdown.value;
            // Base the dropdown ONLY on the dates present in the original newsData from HTML
            const initialDates = Object.keys(newsData).sort((a, b) => new Date(b) - new Date(a));

            dateDropdown.innerHTML = '<option value="">日付を選択してください</option>'; // Clear existing options

            initialDates.forEach(date => {
                 // Only add dates that were originally in the HTML's newsData
                const option = document.createElement('option');
                option.value = date;
                option.textContent = date;
                dateDropdown.appendChild(option);
            });

             // Try to restore selection if it still exists in the original dates
             if (newsData[currentSelectedValue]) {
                 dateDropdown.value = currentSelectedValue;
             } else if (initialDates.length > 0 && !currentSelectedValue) {
                  // Optionally auto-select latest date from initial data if nothing was selected
                 // dateDropdown.value = initialDates[0];
             }
        }

        // Function to add event listeners to admin buttons
        function addEventListenerToButtons() {
            const editButtons = document.querySelectorAll('.edit-button');
            const deleteButtons = document.querySelectorAll('.delete-button');

            editButtons.forEach(button => {
                button.removeEventListener('click', handleEditClick);
                button.addEventListener('click', handleEditClick);
            });

            deleteButtons.forEach(button => {
                 button.removeEventListener('click', handleDeleteClick);
                 button.addEventListener('click', handleDeleteClick);
            });
        }

        // Handler for clicking the edit button in admin list
        function handleEditClick(event) {
            const index = parseInt(event.target.dataset.index);
            const newsToEditInfo = getNewsByGlobalIndex(index);

            if (newsToEditInfo) {
                editingIndex = index;
                document.getElementById('news-date').value = newsToEditInfo.date;
                document.getElementById('news-title').value = newsToEditInfo.title;
                document.getElementById('news-url').value = newsToEditInfo.url;
                document.getElementById('news-summary').value = newsToEditInfo.概要;
                document.getElementById('news-publish-date').value = formatInputDate(newsToEditInfo.配信日); // Format for input
                addNewsForm.querySelector('button[type="submit"]').textContent = '更新';
                addNewsForm.scrollIntoView({ behavior: 'smooth', block: 'start' });
            } else {
                messageContainer.textContent = "編集するニュースが見つかりませんでした。";
                editingIndex = null;
                addNewsForm.reset();
                addNewsForm.querySelector('button[type="submit"]').textContent = '追加';
                setTimeout(() => { messageContainer.textContent = ''; }, 3000);
            }
        }

        // Handler for clicking the delete button in admin list
        function handleDeleteClick(event) {
            const indexToDelete = parseInt(event.target.dataset.index);
            const newsInfo = getNewsByGlobalIndex(indexToDelete);

            if (newsInfo && newsInfo.date && newsInfo.indexInDate !== -1 && groupedNews[newsInfo.date]) {
                if (!confirm(`「${newsInfo.title}」を一時的に削除してもよろしいですか？ (ページ再読み込みで元に戻ります)`)) {
                    return;
                }

                groupedNews[newsInfo.date].splice(newsInfo.indexInDate, 1);
                if (groupedNews[newsInfo.date].length === 0) {
                    delete groupedNews[newsInfo.date];
                }

                try {
                    localStorage.setItem('groupedNews', JSON.stringify(groupedNews));
                     console.log("Temporary admin deletion saved to localStorage.");
                } catch (error) {
                    console.error('localStorageへの一時保存に失敗しました:', error);
                    messageContainer.textContent = 'エラー：削除の一時保存に失敗しました。';
                    // Continue UI update even if save fails
                }

                populateNewsList(); // Update admin list
                // Do NOT update the main dropdown based on temporary deletion
                // updateDateDropdown(); // <-- No

                messageContainer.textContent = 'ニュースを一時的に削除しました。';
                if (editingIndex === indexToDelete) {
                    editingIndex = null;
                    addNewsForm.reset();
                    addNewsForm.querySelector('button[type="submit"]').textContent = '追加';
                }
                setTimeout(() => { messageContainer.textContent = ''; }, 3000);

            } else {
                messageContainer.textContent = '削除するニュースが見つかりませんでした。';
                 setTimeout(() => { messageContainer.textContent = ''; }, 3000);
            }
        }

        // Helper to get news details by global index from the current `groupedNews` state
        function getNewsByGlobalIndex(globalIndex) {
             // This function now operates on the potentially modified 'groupedNews'
             // used by the admin panel, which might differ from the initial page load data.
            let currentGlobalIndex = 0;
            const sortedAdminDates = Object.keys(groupedNews).sort((a, b) => new Date(b) - new Date(a));
            for (const date of sortedAdminDates) {
                 const sortedNewsForAdminDate = groupedNews[date]
                    .map(news => ({ ...news, sortDate: formatInputDate(news.配信日) || '0000-00-00' }))
                    .sort((a, b) => new Date(b.sortDate) - new Date(a.sortDate)); // Ensure consistent order with list

                 for (let i = 0; i < sortedNewsForAdminDate.length; i++) {
                     if (currentGlobalIndex === globalIndex) {
                         // Find the original index in the unsorted groupedNews[date] array
                         // This is complex because the admin list is sorted differently.
                         // Simplification: Assume the edit/delete refers to the item *as currently displayed* in the admin list.
                         // We need the original index within groupedNews[date] to modify it correctly.
                         // Find the actual item in the original groupedNews[date] based on title/url perhaps?
                         // Let's find it by title for now, assuming titles are unique within a date
                         const itemToFind = sortedNewsForAdminDate[i];
                         const originalIndex = groupedNews[date].findIndex(n => n.title === itemToFind.title && n.url === itemToFind.url);

                         if (originalIndex !== -1) {
                            return {
                                date: date,
                                indexInDate: originalIndex, // Use the index in the *original* array
                                ...groupedNews[date][originalIndex]
                            };
                         } else {
                             console.error("Could not find original item index for editing/deleting:", itemToFind);
                             return null; // Item not found in original array, maybe deleted concurrently?
                         }
                     }
                     currentGlobalIndex++;
                 }
            }
            return null; // Not found
        }


        // Helper function to format date strings to YYYY-MM-DD for input[type=date]
        function formatInputDate(dateString) {
           if (!dateString) return '';
           try {
               // Handle "YYYY年M月D日" etc.
               const cleanedString = dateString.replace(/年|月/g, '-').replace(/日/g, '').replace(/\./g, '-').replace(/\//g, '-');
               const parts = cleanedString.split('-');
               if (parts.length === 3) {
                   const year = parts[0];
                   const month = parts[1].padStart(2, '0');
                   const day = parts[2].padStart(2, '0');
                   const normalizedDateStr = `${year}-${month}-${day}`;
                   const dateObj = new Date(normalizedDateStr + 'T00:00:00');
                   if (!isNaN(dateObj.getTime()) && dateObj.getFullYear() == year && (dateObj.getMonth() + 1) == parseInt(month) && dateObj.getDate() == parseInt(day)) {
                       return normalizedDateStr;
                   }
               }
               // Fallback attempt for other formats
               const directDateObj = new Date(cleanedString + 'T00:00:00');
                if (!isNaN(directDateObj.getTime())) {
                   const year = directDateObj.getFullYear();
                   const month = String(directDateObj.getMonth() + 1).padStart(2, '0');
                   const day = String(directDateObj.getDate()).padStart(2, '0');
                   return `${year}-${month}-${day}`;
                }
               // Try YYYYMMDD
                if (/^\d{8}$/.test(dateString)) {
                   const year = dateString.substring(0, 4);
                   const month = dateString.substring(4, 6);
                   const day = dateString.substring(6, 8);
                   const ymdDate = new Date(`${year}-${month}-${day}` + 'T00:00:00');
                   if (!isNaN(ymdDate.getTime())) return `${year}-${month}-${day}`;
                }
               console.warn("Could not parse date for input:", dateString);
               return '';
           } catch (e) {
               console.error("Error formatting date for input:", dateString, e);
               return '';
           }
        }

        // Event listener for toggling the admin news list visibility
        toggleNewsListButton.addEventListener('click', () => {
            isNewsListVisible = !isNewsListVisible;
            newsListContainer.classList.toggle('show', isNewsListVisible);
            toggleNewsListButton.textContent = isNewsListVisible ? '非表示' : '表示';
        });

        // Initial setup on page load
        window.onload = () => {
            // *** CRITICAL CHANGE: ALWAYS load from embedded newsData on page load ***
            try {
                groupedNews = JSON.parse(JSON.stringify(newsData)); // Deep copy from HTML source
                 console.log("Page loaded. Initializing news data from embedded HTML.");
            } catch (error) {
                console.error("Error initializing news data from embedded HTML:", error);
                // Fallback to empty if newsData is somehow corrupt in HTML
                groupedNews = {};
            }

            // Populate dropdown based on the initial data loaded from HTML
            updateDateDropdown();

            // Select and display the latest date from the initial data by default
            const initialDates = Object.keys(groupedNews).sort((a, b) => new Date(b) - new Date(a));
            if (initialDates.length > 0) {
                const latestDate = initialDates[0];
                if (!dateDropdown.value) { // Select latest only if nothing is pre-selected (e.g. by updateDateDropdown restoration)
                    dateDropdown.value = latestDate;
                }
                displayNews(dateDropdown.value); // Display based on current dropdown value
            } else {
                displayNews(null); // Display initial message if no dates in HTML data
            }
        };
    </script>
</body>
</html>
